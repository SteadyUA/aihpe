<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HTML Preview Chat</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="header-top">
        <h1>HTML Preview Chat</h1>
        <div class="global-actions">
        </div>
      </div>
      <div class="session-bar">
        <div id="session-tabs" class="session-tabs"></div>
        <div class="session-controls">
            <span id="session-label" class="sr-only"></span>
        </div>
      </div>
    </header>
    <main class="app">
      <section class="chat-panel">
        <div class="messages" id="messages" aria-live="polite"></div>
        <form id="chat-form" class="chat-form">
          <div id="selection-display-area" class="selection-display-area" hidden>
            <span class="selection-tag">
               <code class="selection-tag-code" id="selection-tag-code"></code>
               <button type="button" class="selection-tag-close" id="selection-tag-close" aria-label="Сбросить выбор">×</button>
            </span>
          </div>
          <button type="button" id="picker-button" class="picker-button-chat" aria-pressed="false">
              Выбрать элемент
          </button>
          <label for="message-input" class="sr-only">Инструкция</label>
          <textarea
            id="message-input"
            name="message"
            rows="4"
            placeholder="Опишите, какую страницу создать или изменить..."
            required
          ></textarea>
          <div class="form-actions">
            <button type="submit" id="send-button">Отправить</button>
            <button type="button" id="clone-session-button" class="secondary-button" title="Клонировать текущую сессию">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
              Clone
            </button>
          </div>
        </form>
      </section>
      <section class="preview-panel">
        <div class="preview-toolbar">
          <div class="preview-actions">
            <button type="button" id="open-new-window-button" class="preview-action" title="Открыть в новом окне">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                <polyline points="15 3 21 3 21 9"></polyline>
                <line x1="10" y1="14" x2="21" y2="3"></line>
              </svg>
              <span class="sr-only">Открыть в новом окне</span>
            </button>
            <button type="button" id="download-session-button" class="preview-action" title="Скачать файлы">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
              <span class="sr-only">Скачать файлы</span>
            </button>
          </div>
          <div class="device-controls">
            <select id="device-select" class="device-select" disabled>
              <!-- Options populated by JS -->
            </select>
            <label class="toggle">
              <input type="checkbox" id="mobile-toggle" />
              <span class="toggle-switch" aria-hidden="true"></span>
              <span class="toggle-label">Device Mode</span>
            </label>
          </div>
        </div>
        <div class="preview-frame-wrapper" id="preview-wrapper">
            <iframe id="preview-frame" title="Предпросмотр"></iframe>
          </div>

        <div class="assets">
          <div class="assets-tabs" role="tablist">
            <button type="button" class="asset-tab" role="tab" aria-selected="false" aria-controls="panel-html" data-type="html">index.html</button>
            <button type="button" class="asset-tab" role="tab" aria-selected="false" aria-controls="panel-css" data-type="css">styles.css</button>
            <button type="button" class="asset-tab" role="tab" aria-selected="false" aria-controls="panel-js" data-type="js">script.js</button>
            <div class="assets-spacer"></div>
            <button type="button" class="asset-close" aria-label="Закрыть код">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
            </button>
          </div>
          <div class="assets-panels">
            <div id="panel-html" class="asset-panel" role="tabpanel" hidden>
              <pre><code id="html-code"></code></pre>
            </div>
            <div id="panel-css" class="asset-panel" role="tabpanel" hidden>
              <pre><code id="css-code"></code></pre>
            </div>
            <div id="panel-js" class="asset-panel" role="tabpanel" hidden>
              <pre><code id="js-code"></code></pre>
            </div>
          </div>
        </div>
      </section>
    </main>
    <script type="module" src="main.js"></script>
  </body>
</html>
